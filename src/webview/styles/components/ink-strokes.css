/**
 * Ink Strokes - Inter-Agent Communication Visualization
 * Story 11.7 - Animated SVG paths between agents
 *
 * Styles for sumi-e inspired brush strokes that travel between agent characters.
 */

/* ============================================================================
   SVG Overlay
   ============================================================================ */

/**
 * Full-screen SVG overlay for ink strokes
 * Positioned fixed to stay above editor but below tooltips
 */
.ink-stroke-overlay {
    /* Positioning handled inline, but ensure it's not overridden */
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;

    /* No interaction unless tooltip is attached */
    pointer-events: none;

    /* Below tooltips but above agent characters */
    z-index: 9998;

    /* Smooth fade-out when stroke completes */
    transition: opacity 300ms ease-out;
}

/* ============================================================================
   Ink Path
   ============================================================================ */

/**
 * The actual stroke path
 * Uses stroke-dashoffset animation for progressive drawing effect
 */
.ink-path {
    /* Semi-transparent for authentic brush feel */
    opacity: 0.8;

    /* Smooth animation timing */
    transition: stroke-dashoffset 1200ms cubic-bezier(0.4, 0.0, 0.2, 1);

    /* Ensure proper rendering */
    vector-effect: non-scaling-stroke;
}

/**
 * Optional: Add subtle texture for authentic ink feel
 * (Requires SVG filter definition in HTML)
 */
.ink-stroke-overlay.textured .ink-path {
    filter: url(#ink-texture);
}

/* ============================================================================
   Stroke Tooltip
   ============================================================================ */

/**
 * Tooltip that shows message content on stroke hover
 * Follows mouse cursor
 */
.ink-stroke-tooltip {
    /* Positioning handled inline */
    position: fixed;

    /* Styling */
    background: var(--tooltip-bg, #1E1E1E);
    color: var(--tooltip-text, #FFFFFF);
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 12px;
    font-family: var(--font-mono, 'Monaco', 'Courier New', monospace);

    /* Prevent interaction */
    pointer-events: none;

    /* Smooth fade */
    opacity: 0;
    transition: opacity 200ms ease;

    /* Above everything */
    z-index: 10000;

    /* Visual depth */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);

    /* Prevent wrapping */
    white-space: nowrap;

    /* Prevent selection */
    user-select: none;
}

/**
 * Tooltip visible state
 * (Applied via inline style, but defined here for reference)
 */
.ink-stroke-tooltip.visible {
    opacity: 1;
}

/* ============================================================================
   Color Variants
   ============================================================================ */

/**
 * Routine (non-critical) strokes use ink black
 */
.ink-path.routine {
    stroke: var(--ink-black, #2C3E50);
}

/**
 * Critical strokes use vermillion red
 */
.ink-path.critical {
    stroke: var(--vermillion-red, #E74C3C);
}

/* ============================================================================
   Accessibility
   ============================================================================ */

/**
 * High contrast mode: Increase opacity and stroke width
 */
@media (prefers-contrast: high) {
    .ink-path {
        opacity: 1;
        stroke-width: 3;
    }
}

/**
 * Reduced motion: No animation, instant appearance
 */
@media (prefers-reduced-motion: reduce) {
    .ink-stroke-overlay,
    .ink-path,
    .ink-stroke-tooltip {
        transition: none !important;
        animation: none !important;
    }

    .ink-path {
        stroke-dashoffset: 0 !important;
    }
}

/* ============================================================================
   Performance Mode
   ============================================================================ */

/**
 * Performance mode: Simplified animations
 */
body.performance-mode .ink-stroke-overlay {
    /* Shorter animation */
    transition-duration: 150ms !important;
}

body.performance-mode .ink-path {
    /* Faster stroke drawing */
    transition-duration: 800ms !important;

    /* Slightly less opacity for performance */
    opacity: 0.6;
}

body.performance-mode .ink-stroke-tooltip {
    /* Instant tooltip */
    transition: none;
}

/* ============================================================================
   Dark/Light Theme Support
   ============================================================================ */

/**
 * Dark theme (default)
 */
body.vscode-dark .ink-stroke-tooltip {
    background: #1E1E1E;
    color: #FFFFFF;
    border: 1px solid #3C3C3C;
}

/**
 * Light theme
 */
body.vscode-light .ink-stroke-tooltip {
    background: #FFFFFF;
    color: #1E1E1E;
    border: 1px solid #D0D0D0;
}

/**
 * High contrast theme
 */
body.vscode-high-contrast .ink-stroke-tooltip {
    background: #000000;
    color: #FFFFFF;
    border: 2px solid #FFFFFF;
}

body.vscode-high-contrast .ink-path {
    stroke-width: 3;
    opacity: 1;
}

/* ============================================================================
   Optional: Ink Texture Filter
   ============================================================================ */

/**
 * SVG filter for authentic ink texture
 * Add to webview HTML if desired:
 *
 * <svg style="position: absolute; width: 0; height: 0;">
 *   <defs>
 *     <filter id="ink-texture">
 *       <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" />
 *       <feDisplacementMap in="SourceGraphic" scale="2" />
 *     </filter>
 *   </defs>
 * </svg>
 */

/* ============================================================================
   Debug Mode
   ============================================================================ */

/**
 * Debug mode: Show stroke control points
 */
body.debug-mode .ink-stroke-overlay::after {
    content: '';
    position: absolute;
    width: 8px;
    height: 8px;
    background: red;
    border-radius: 50%;
    pointer-events: none;
}
